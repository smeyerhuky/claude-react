import{c as k,r,j as e,M as ie,R,f as oe,g as de,h as ce,i as he,Z as ue,B as z,P as xe,S as J,k as Q,l as T,m as S,n as p,o as d}from"./index-Q_fJBb9y.js";import"./scroll-area-DqFvZM6D.js";import{T as me}from"./trash-2-GcKB1csV.js";/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],pe=k("gauge",ge);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],ve=k("square-pen",be),ee=r.memo(({track:s,isLast:N,onPlay:O,onEdit:V,onRemove:F,onTransitionChange:$,onCrossfadeDurationChange:C,onMixPointChange:y,onSetCuePoint:I,onWaveformReady:w,onSpectrogramReady:E,onSeekTrack:a,isPlaying:D=!1,currentTime:P=0})=>{const m=r.useRef(null),j=r.useRef(null),[c,b]=r.useState(0),[h,x]=r.useState(!1),[v,H]=r.useState(1),[i,se]=r.useState(!1),[A,te]=r.useState(!1),[L,_]=r.useState(null),[U,X]=r.useState(!1),M=t=>{const l=Math.floor(t/60),o=Math.floor(t%60);return`${l}:${o.toString().padStart(2,"0")}`};R.useEffect(()=>{m.current&&(w==null||w(s.chainId,m.current))},[s.chainId,w]),R.useEffect(()=>{j.current&&(E==null||E(s.chainId,j.current))},[s.chainId,E]),R.useEffect(()=>{if(D&&!h){const t=s.duration>0?P/s.duration*100:0;b(Math.min(100,Math.max(0,t)))}},[P,s.duration,D,h]);const B=r.useCallback(t=>{var o;if(!h)return;const l=(o=m.current)==null?void 0:o.getBoundingClientRect();if(l){const u=t.clientX-l.left,n=Math.min(100,Math.max(0,u/l.width*100));b(n);const g=n/100*s.duration;a==null||a(s.id,g)}},[h,s.duration,s.id,a]),ae=r.useCallback(t=>{t.preventDefault(),x(!0),B(t)},[B]),re=r.useCallback(t=>{var u;t.preventDefault(),x(!0);const l=t.touches[0],o=(u=m.current)==null?void 0:u.getBoundingClientRect();if(o){const n=l.clientX-o.left,g=Math.min(100,Math.max(0,n/o.width*100));b(g);const f=g/100*s.duration;a==null||a(s.id,f)}},[s.duration,s.id,a]),G=r.useCallback(t=>{const l=t.currentTarget.getBoundingClientRect(),o=t.clientX-l.left,u=Math.min(100,Math.max(0,o/l.width*100));b(u);const n=u/100*s.duration;a==null||a(s.id,n)},[s.duration,s.id,a]),K=r.useCallback(t=>{const l=t.currentTarget.getBoundingClientRect(),o=t.clientX-l.left,u=Math.min(100,Math.max(0,o/l.width*100));_(u)},[]),q=r.useCallback(()=>{_(null),X(!1)},[]),W=r.useCallback(()=>{X(!0)},[]);return R.useEffect(()=>{const t=l=>{if(i)switch(l.key){case"ArrowLeft":l.preventDefault();const o=Math.max(0,c/100*s.duration-1),u=o/s.duration*100;b(u),a==null||a(s.id,o);break;case"ArrowRight":l.preventDefault();const n=Math.min(s.duration,c/100*s.duration+1),g=n/s.duration*100;b(g),a==null||a(s.id,n);break}};if(i)return document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)},[i,c,s.duration,s.id,a]),R.useEffect(()=>{const t=n=>B(n),l=n=>{var Z;if(!h)return;const g=n.touches[0],f=(Z=m.current)==null?void 0:Z.getBoundingClientRect();if(f){const le=g.clientX-f.left,Y=Math.min(100,Math.max(0,le/f.width*100));b(Y);const ne=Y/100*s.duration;a==null||a(s.id,ne)}},o=()=>{var n;if(x(!1),h&&((n=m.current)==null?void 0:n.getBoundingClientRect())){const f=c/100*s.duration;a==null||a(s.id,f)}},u=()=>{var n;if(x(!1),h&&((n=m.current)==null?void 0:n.getBoundingClientRect())){const f=c/100*s.duration;a==null||a(s.id,f)}};if(h)return document.addEventListener("mousemove",t),document.addEventListener("mouseup",o),document.addEventListener("touchmove",l),document.addEventListener("touchend",u),()=>{document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",o),document.removeEventListener("touchmove",l),document.removeEventListener("touchend",u)}},[h,B,c,s.duration,s.id,a]),e.jsxs("div",{className:"relative group",children:[e.jsx(oe,{className:"bg-gradient-to-br from-gray-800 to-gray-900 border-gray-700 hover:border-purple-500 transition-all hover:shadow-lg hover:shadow-purple-500/20",children:e.jsxs(de,{className:`${i?"p-4":"p-2"} transition-all duration-300`,children:[e.jsxs("div",{className:`flex justify-between items-center ${i?"mb-3":"mb-2"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[e.jsx("button",{onClick:()=>se(!i),className:"p-1 hover:bg-white/10 rounded transition-colors",title:i?"Collapse":"Expand",children:i?e.jsx(ce,{className:"w-4 h-4 text-gray-400"}):e.jsx(he,{className:"w-4 h-4 text-gray-400"})}),e.jsx("h3",{className:`${i?"text-lg":"text-sm"} font-bold text-green-400 truncate`,children:s.name}),!i&&e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsxs("span",{className:"text-cyan-400",children:[s.tempo," BPM"]}),e.jsx("span",{className:"text-purple-400",children:s.key}),e.jsx("span",{className:"text-gray-400",children:M(s.duration)})]}),e.jsxs("div",{className:"flex items-center gap-1 bg-black/30 rounded px-1 py-0.5 ml-auto",children:[e.jsx("button",{onClick:t=>{t.stopPropagation(),H(Math.max(.5,v-.1))},className:"p-0.5 hover:bg-white/10 rounded transition-colors",title:"Decrease speed",children:e.jsx(pe,{className:"w-3 h-3 text-cyan-400"})}),e.jsxs("span",{className:"text-xs font-mono text-white min-w-[2rem] text-center",children:[v.toFixed(1),"x"]}),e.jsx("button",{onClick:t=>{t.stopPropagation(),H(Math.min(2,v+.1))},className:"p-0.5 hover:bg-white/10 rounded transition-colors",title:"Increase speed",children:e.jsx(ue,{className:"w-3 h-3 text-yellow-400"})})]})]}),e.jsxs("div",{className:"flex gap-1 ml-2",children:[e.jsx(z,{size:"sm",variant:"ghost",onClick:()=>O(s.id),className:"h-7 px-2 hover:bg-green-600 hover:text-white",children:e.jsx(xe,{className:"w-3 h-3"})}),e.jsx(z,{size:"sm",variant:"ghost",onClick:()=>te(!A),className:"h-7 px-2 hover:bg-blue-600 hover:text-white",children:e.jsx(ve,{className:"w-3 h-3"})}),e.jsx(z,{size:"sm",variant:"ghost",onClick:()=>F(s.chainId),className:"h-7 px-2 hover:bg-red-600 hover:text-white",children:e.jsx(me,{className:"w-3 h-3"})})]})]}),e.jsxs("div",{className:`relative ${i?"h-20":"h-12"} bg-black/50 rounded-lg ${i?"mb-4":"mb-2"} overflow-hidden border border-gray-700 transition-all duration-300 cursor-pointer group`,onClick:G,onMouseMove:K,onMouseEnter:W,onMouseLeave:q,children:[e.jsx("canvas",{ref:m,className:"w-full h-full",id:`waveform_${s.chainId}`}),L!==null&&U&&!h&&e.jsx("div",{className:"absolute top-0 bottom-0 w-0.5 bg-white/30 pointer-events-none transition-all",style:{left:`${L}%`},children:e.jsx("div",{className:"absolute -top-6 left-1/2 -translate-x-1/2 bg-gray-900 px-2 py-1 rounded text-xs text-white whitespace-nowrap border border-gray-700",children:M(L/100*s.duration)})}),e.jsxs("div",{className:"absolute top-0 bottom-0 w-2 -ml-1 cursor-ew-resize group/playhead touch-none z-10",style:{left:`${c}%`},onMouseDown:t=>{t.stopPropagation(),ae(t)},onTouchStart:t=>{t.stopPropagation(),re(t)},title:`${M(c/100*s.duration)} / ${M(s.duration)}`,children:[e.jsx("div",{className:"absolute left-1/2 top-0 bottom-0 w-1 -translate-x-1/2 bg-red-500 shadow-lg transition-all group-hover/playhead:w-1.5 group-hover/playhead:bg-red-400"}),e.jsx("div",{className:"absolute -top-2 left-1/2 -translate-x-1/2 w-0 h-0 border-l-[6px] border-l-transparent border-r-[6px] border-r-transparent border-t-[8px] border-t-red-500 group-hover/playhead:border-t-red-400 transition-colors"}),e.jsx("div",{className:"absolute -bottom-2 left-1/2 -translate-x-1/2 w-0 h-0 border-l-[6px] border-l-transparent border-r-[6px] border-r-transparent border-b-[8px] border-b-red-500 group-hover/playhead:border-b-red-400 transition-colors"}),(h||i)&&e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 pointer-events-none",children:e.jsx("div",{className:"bg-red-500 text-white text-xs px-2 py-0.5 rounded-full whitespace-nowrap transform -translate-x-8",children:M(c/100*s.duration)})})]}),D&&e.jsx("div",{className:"absolute top-0 bottom-0 bg-green-500/20 pointer-events-none transition-all",style:{width:`${c}%`}})]}),i&&e.jsxs("div",{className:"relative h-24 bg-black/50 rounded-lg mb-4 overflow-hidden border border-gray-700 cursor-pointer group",onClick:G,onMouseMove:K,onMouseEnter:W,onMouseLeave:q,children:[e.jsx("canvas",{ref:j,className:"w-full h-full",id:`spectrogram_${s.chainId}`}),L!==null&&U&&!h&&e.jsx("div",{className:"absolute top-0 bottom-0 w-0.5 bg-white/30 pointer-events-none",style:{left:`${L}%`}}),e.jsx("div",{className:"absolute top-0 bottom-0 w-1 bg-red-500 shadow-lg pointer-events-none",style:{left:`${c}%`}})]}),e.jsxs("div",{className:`bg-black/30 rounded-lg ${i?"p-3 space-y-3":"p-2"}`,children:[A&&!i&&e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("input",{type:"range",min:"0",max:"100",defaultValue:s.mixPoint||75,className:"flex-1 h-1 bg-gray-700 rounded-lg appearance-none cursor-pointer",onChange:t=>y==null?void 0:y(s.chainId,t.target.value)}),e.jsxs(J,{value:s.transitionType,onValueChange:t=>$(s.chainId,t),children:[e.jsx(Q,{className:"w-32 h-7 bg-gray-800 border-gray-600 text-xs",children:e.jsx(T,{})}),e.jsxs(S,{className:"bg-gray-800 border-gray-600 z-50",sideOffset:5,children:[e.jsx(p,{value:d.CROSSFADE,className:"text-white hover:bg-gray-700 focus:bg-gray-700 text-xs",children:"ðŸŒŠ Fade"}),e.jsx(p,{value:d.CUT,className:"text-white hover:bg-gray-700 focus:bg-gray-700 text-xs",children:"âœ‚ï¸ Cut"}),e.jsx(p,{value:d.ECHO,className:"text-white hover:bg-gray-700 focus:bg-gray-700 text-xs",children:"ðŸ”Š Echo"}),e.jsx(p,{value:d.FILTER,className:"text-white hover:bg-gray-700 focus:bg-gray-700 text-xs",children:"ðŸŽµ Filter"}),e.jsx(p,{value:d.REVERSE,className:"text-white hover:bg-gray-700 focus:bg-gray-700 text-xs",children:"âª Reverse"})]})]})]}),i&&e.jsxs("div",{className:"grid grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400 text-xs",children:"Duration:"}),e.jsx("div",{className:"font-semibold text-green-400",children:M(s.duration)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400 text-xs",children:"BPM:"}),e.jsx("div",{className:"font-semibold text-cyan-400",children:s.tempo})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400 text-xs",children:"Key:"}),e.jsx("div",{className:"font-semibold text-purple-400",children:s.key})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400 text-xs",children:"Type:"}),e.jsx("div",{className:"font-semibold text-yellow-400",children:s.type})]})]}),i&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:"Transition Type:"}),e.jsxs(J,{value:s.transitionType,onValueChange:t=>$(s.chainId,t),children:[e.jsx(Q,{className:"bg-gray-800 border-gray-600 text-white hover:bg-gray-700 h-8 text-sm",children:e.jsx(T,{})}),e.jsxs(S,{className:"bg-gray-800 border-gray-600 z-50",sideOffset:5,children:[e.jsx(p,{value:d.CROSSFADE,className:"text-white hover:bg-gray-700 focus:bg-gray-700",children:"ðŸŒŠ Crossfade"}),e.jsx(p,{value:d.CUT,className:"text-white hover:bg-gray-700 focus:bg-gray-700",children:"âœ‚ï¸ Hard Cut"}),e.jsx(p,{value:d.ECHO,className:"text-white hover:bg-gray-700 focus:bg-gray-700",children:"ðŸ”Š Echo Fade"}),e.jsx(p,{value:d.FILTER,className:"text-white hover:bg-gray-700 focus:bg-gray-700",children:"ðŸŽµ Filter Sweep"}),e.jsx(p,{value:d.REVERSE,className:"text-white hover:bg-gray-700 focus:bg-gray-700",children:"âª Reverse"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:"Crossfade Duration:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"range",min:"0.5",max:"8",step:"0.1",defaultValue:s.crossfadeDuration||2,className:"flex-1 h-1 bg-gray-700 rounded-lg appearance-none cursor-pointer",onChange:t=>{C==null||C(s.chainId,t.target.value)}}),e.jsxs("span",{className:"text-xs text-gray-400 min-w-[2rem]",children:[s.crossfadeDuration||2,"s"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:"Mix Point:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"range",min:"0",max:"100",step:"1",defaultValue:s.mixPoint||75,className:"flex-1 h-1 bg-gray-700 rounded-lg appearance-none cursor-pointer",onChange:t=>{y==null||y(s.chainId,t.target.value)}}),e.jsxs("span",{className:"text-xs text-gray-400 min-w-[2rem]",children:[s.mixPoint||75,"%"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-2 pt-2 border-t border-gray-700",children:[e.jsx("button",{className:"px-2 py-1 bg-blue-600 hover:bg-blue-700 rounded text-xs font-medium transition-colors",onClick:()=>{const t=c/100*s.duration;I==null||I(s.chainId,t)},children:"ðŸŽ¯ Set Cue"}),e.jsx("button",{className:"px-2 py-1 bg-green-600 hover:bg-green-700 rounded text-xs font-medium transition-colors",children:"ðŸŽµ BPM Match"}),e.jsx("button",{className:"px-2 py-1 bg-purple-600 hover:bg-purple-700 rounded text-xs font-medium transition-colors",children:"ðŸŽ¹ Key Sync"}),e.jsx("button",{className:"px-2 py-1 bg-orange-600 hover:bg-orange-700 rounded text-xs font-medium transition-colors",children:"ðŸ”¥ Preview"})]})]})]})]})}),!N&&e.jsx("div",{className:"absolute -bottom-3 left-0 right-0 z-10 px-4",children:e.jsx("div",{className:"relative h-6 bg-gradient-to-r from-transparent via-purple-500/30 to-transparent rounded-full",children:e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"bg-gray-900 px-2 py-0.5 rounded-full text-xs text-purple-400 font-medium border border-purple-500/50",children:[s.transitionType===d.CROSSFADE&&`ðŸŒŠ ${s.crossfadeDuration||2}s fade`,s.transitionType===d.CUT&&"âœ‚ï¸ Cut",s.transitionType===d.ECHO&&"ðŸ”Š Echo",s.transitionType===d.FILTER&&"ðŸŽµ Filter",s.transitionType===d.REVERSE&&"âª Reverse"]})})})})]})});ee.displayName="ChainTrack";const fe=r.memo(({chain:s,onDrop:N,onTrackPlay:O,onTrackEdit:V,onTrackRemove:F,onTransitionChange:$,onCrossfadeDurationChange:C,onMixPointChange:y,onSetCuePoint:I,onWaveformReady:w,onSpectrogramReady:E,onSeekTrack:a,isPlaying:D=!1,currentTime:P=0})=>{const[m,j]=r.useState(!1),c=r.useCallback(x=>{x.preventDefault(),j(!0)},[]),b=r.useCallback(()=>{j(!1)},[]),h=r.useCallback(x=>{x.preventDefault(),j(!1);const v=x.dataTransfer.getData("trackId");v&&(N==null||N(v))},[N]);return e.jsxs("div",{className:"h-full bg-gray-900/95 border border-gray-700 rounded-lg flex flex-col",children:[e.jsx("div",{className:"p-4 border-b border-gray-700 flex-shrink-0",children:e.jsx("h3",{className:"text-lg font-bold text-purple-400",children:"Chain Builder"})}),e.jsx("div",{className:"flex-1 p-4 overflow-y-auto",onDragOver:c,onDragLeave:b,onDrop:h,children:s.length===0?e.jsx("div",{className:`
              h-full border-2 border-dashed rounded-xl min-h-[400px]
              flex items-center justify-center transition-all
              ${m?"border-green-400 bg-green-500/10 scale-[1.02]":"border-gray-600 bg-gray-800/20"}
            `,children:e.jsxs("div",{className:"text-center text-gray-400",children:[e.jsx(ie,{className:"w-20 h-20 mx-auto mb-6"}),e.jsx("p",{className:"text-3xl mb-3",children:"ðŸŽµ Drag tracks here to build your EDM chain"}),e.jsx("p",{className:"text-lg mb-2",children:"Supports MP3, WAV, OGG formats"}),e.jsx("p",{className:"text-base mt-3",children:"Start with major tracks, then add fillers and samples"}),e.jsx("p",{className:"text-sm mt-6 text-blue-400",children:"Use the Track Library on the left to upload files"})]})}):e.jsx("div",{className:"space-y-3",children:s.map((x,v)=>e.jsx(ee,{track:x,index:v,isLast:v===s.length-1,onPlay:O,onEdit:V,onRemove:F,onTransitionChange:$,onCrossfadeDurationChange:C,onMixPointChange:y,onSetCuePoint:I,onWaveformReady:w,onSpectrogramReady:E,onSeekTrack:a,isPlaying:D,currentTime:P},x.chainId))})})]})});fe.displayName="ChainBuilder";export{fe as ChainBuilder};
